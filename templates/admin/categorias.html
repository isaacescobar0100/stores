{% extends 'admin/base_admin.html' %}

{% block page_title %}Categorías{% endblock %}

{% block admin_content %}
<div class="action-bar">
    <div class="action-bar-left">
        <span>{{ categorias|length }} categorías</span>
    </div>
    <button class="btn btn-primary" onclick="openModal('modalNuevo')">
        + Nueva Categoría
    </button>
</div>

<div class="card">
    <div class="card-body" style="padding: 0;">
        <table class="table">
            <thead>
                <tr>
                    <th>Orden</th>
                    <th>Nombre</th>
                    <th>Descripción</th>
                    <th>Estado</th>
                    <th>Acciones</th>
                </tr>
            </thead>
            <tbody>
                {% for cat in categorias %}
                <tr>
                    <td>{{ cat.orden }}</td>
                    <td><strong>{{ cat.nombre }}</strong></td>
                    <td class="text-muted">{{ cat.descripcion or '-' }}</td>
                    <td>
                        {% if cat.activo %}
                            <span class="badge badge-success">Activa</span>
                        {% else %}
                            <span class="badge badge-danger">Inactiva</span>
                        {% endif %}
                    </td>
                    <td>
                        <button class="btn btn-secondary btn-sm">Editar</button>
                    </td>
                </tr>
                {% else %}
                <tr>
                    <td colspan="5" class="text-center text-muted" style="padding: 40px;">
                        No hay categorías
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
</div>

<!-- Modal Nueva Categoría -->
<div class="modal" id="modalNuevo">
    <div class="modal-content">
        <div class="modal-header">
            <h3>Nueva Categoría</h3>
            <button class="modal-close" onclick="closeModal('modalNuevo')">&times;</button>
        </div>
        <form action="{{ url_for('admin_categoria_crear') }}" method="POST">
            <div class="modal-body">
                <div class="form-group">
                    <label class="form-label">Nombre *</label>
                    <input type="text" name="nombre" class="form-input" required>
                </div>
                <div class="form-group">
                    <label class="form-label">Descripción</label>
                    <textarea name="descripcion" class="form-input" rows="2"></textarea>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" onclick="closeModal('modalNuevo')">Cancelar</button>
                <button type="submit" class="btn btn-primary">Crear Categoría</button>
            </div>
        </form>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script>
function openModal(id) {
    document.getElementById(id).classList.add('active');
}

function closeModal(id) {
    document.getElementById(id).classList.remove('active');
}

document.querySelectorAll('.modal').forEach(modal => {
    modal.addEventListener('click', function(e) {
        if (e.target === this) closeModal(this.id);
    });
});
</script>
{% endblock %}
